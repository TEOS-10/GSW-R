<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>gsw • gsw</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="gsw">
<meta property="og:description" content="gsw">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsw</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/gsw.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TEOS-10/GSW-R/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gsw_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>gsw</h1>
                        <h4 class="author">Dan Kelley (<a href="https://orcid.org/0000-0001-7808-5911" class="uri">https://orcid.org/0000-0001-7808-5911</a>) and Clark Richards (<a href="https://orcid.org/0000-0002-7833-206X" class="uri">https://orcid.org/0000-0002-7833-206X</a>)</h4>
            
            <h4 class="date">2021-07-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TEOS-10/GSW-R/blob/master/vignettes/gsw.Rmd"><code>vignettes/gsw.Rmd</code></a></small>
      <div class="hidden name"><code>gsw.Rmd</code></div>

    </div>

    
    
<p><strong>Abstract.</strong> The <code>gsw</code> package provides an R implementation of the Gibbs SeaWater toolbox for the calculation of seawater properties (version 3.05). This vignette outlines how to use <code>gsw</code> alone or as part of the <code>oce</code> package.</p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In recent years, thermodynamic considerations have led to improved formulae for the calculation of seawater properties (IOC, 2010; Millero et al 2010), an important component of which is the Gibbs-SeaWater (GSW) toolbox (McDougall 2011; Pawlowicz et al 2012). The <code>gsw</code> package is an R version of GSW, which may be used independently or within the more general <code>oce</code> package (Kelley and Richards 2016).</p>
<p>This vignette sketches how to use <code>gsw</code>. Readers are assumed to be familiar with oceanographic processing, and at least somewhat familiar with GSW. A good resource for learning more about GSW is <a href="http://www.teos-10.org">http://www.teos-10.org</a>, which provides technical manuals for the Matlab version of GSW <a href="http://www.teos-10.org/pubs/gsw/html/gsw_contents.html">http://www.teos-10.org/pubs/gsw/html/gsw_contents.html</a>, along with white papers and links to the growing peer-reviewed literature on the topic.</p>
<p>The <code>gsw</code> framework involves a series of wrappers that connect R with the C version of the Gibbs Seawater library. This yields high processing speed and the minimization of transliteration errors increases reliability. The incorporation of GSW check values into the package-building process is an additional measure taken to achieve reliability.</p>
<p>By design, the documentation of <code>gsw</code> functions is spare, amounting mainly to an explanation of function arguments and return values, with most other details being provided through hyperlinks to the GSW reference documentation. The idea is to avoid duplication and to encourage users to consult the technical materials linked to the GSW functions mimicked in <code>gsw</code>. The GSW system is somewhat complex, and analysts owe it to themselves to learn how it works, and also to develop an appreciation for its scientific context by consulting various documents at <a href="http://www.teos-10.org">http://www.teos-10.org</a>, including expansive white papers and pointers to the growing peer-reviewed literature (Wright et al. 2011; McDougall et al. 2012; Graham et al. 2013)</p>
</div>
<div id="using-gsw-independent-of-oce" class="section level1">
<h1 class="hasAnchor">
<a href="#using-gsw-independent-of-oce" class="anchor"></a>Using gsw independent of oce</h1>
<p>Suppose a water sample taken at pressure (For practical reasons, <code>gsw</code> goes beyond SI to incorporate oceanographic units, such as decibars for pressure.) 100 dbar, longitude 188E and latitude 4N, reveals Practical Salinity 35 and in-situ temperature 10<span class="math inline">\(^\circ\)</span>C (ITS-90). Then the Absolute Salinity may be calculated as follows.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://teos-10.github.io/GSW-R">gsw</a></span><span class="op">)</span>
<span class="va">SA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsw_SA_from_SP.html">gsw_SA_from_SP</a></span><span class="op">(</span>SP<span class="op">=</span><span class="fl">35</span>, p<span class="op">=</span><span class="fl">100</span>, longitude<span class="op">=</span><span class="fl">188</span>, latitude<span class="op">=</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<p>This yields <code>SA</code>=35.1655491 [g/kg], which can then be used to calculate Conservative Temperature as follows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">CT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsw_CT_from_t.html">gsw_CT_from_t</a></span><span class="op">(</span>SA<span class="op">=</span><span class="va">SA</span>, t<span class="op">=</span><span class="fl">10</span>, p<span class="op">=</span><span class="fl">100</span><span class="op">)</span></code></pre></div>
<p>The above yields <code>CT</code>=9.9782488 [<span class="math inline">\(^\circ\)</span>C]. Readers familiar with GSW will recognize the function and argument names, and are likely to find the other functions needed for their work among the roughly sixty functions that <code>gsw</code> provides.</p>
</div>
<div id="using-gsw-within-oce" class="section level1">
<h1 class="hasAnchor">
<a href="#using-gsw-within-oce" class="anchor"></a>Using gsw within oce</h1>
<p>Many <code>oce</code> plotting functions have an argument named <code>eos</code> that can be set to the string <code>"unesco"</code> to get the older seawater formulation, or to <code>"gsw"</code> to get the newer one. For example, the <code>section</code> dataset provided by <code>oce</code> holds a sequence of CTD casts in the North Atlantic. Individual casts may be selected by index, so a TS diagram of the station at index 100 (south of Cape Cod in 4000 m of water) can be plotted as follows (the figure is not included here, because the oce package depends on the gsw package, so automated build systems will not be able to build the figure).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">oce</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">section</span><span class="op">)</span>
<span class="va">ctd</span> <span class="op">&lt;-</span> <span class="va">section</span><span class="op">[[</span><span class="st">"station"</span>, <span class="fl">100</span><span class="op">]</span><span class="op">]</span>
<span class="va">Slim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">34.8</span>, <span class="fl">37.0</span><span class="op">)</span>
<span class="va">Tlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>
<span class="fu">plotTS</span><span class="op">(</span><span class="va">ctd</span>, Slim<span class="op">=</span><span class="va">Slim</span>, Tlim<span class="op">=</span><span class="va">Tlim</span>, eos<span class="op">=</span><span class="st">"unesco"</span><span class="op">)</span></code></pre></div>
<p>For comparison, it helps to plot a <code>gsw</code> equivalent with the same plot limits.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plotTS</span><span class="op">(</span><span class="va">ctd</span>, Slim<span class="op">=</span><span class="va">Slim</span>, Tlim<span class="op">=</span><span class="va">Tlim</span>, eos<span class="op">=</span><span class="st">"gsw"</span><span class="op">)</span></code></pre></div>
<p>Most hydrography-related functions of <code>oce</code> provide this <code>eos</code> argument for selecting the seawater formulation. This includes functions for plotting and for calculating. In addition, most of the objects within <code>oce</code> have accessors that can return temperature and salinity in either the <code>UNESCO</code> or GSW scheme. For example, the ratio of Conservative Temperature to <code>UNESCO</code>-formulated potential temperature <span class="math inline">\(\theta\)</span> for all the CTD profiles in <code>section</code> is constructed with</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">section</span><span class="op">[[</span><span class="st">"CT"</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">section</span><span class="op">[[</span><span class="st">"theta"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">section</span><span class="op">[[</span><span class="st">"CT"</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">f</span>, main<span class="op">=</span><span class="st">""</span>, xlab<span class="op">=</span><span class="st">"(CT-theta)/CT"</span><span class="op">)</span></code></pre></div>
<p>A salinity comparison is constructed with</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">section</span><span class="op">[[</span><span class="st">"SA"</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">section</span><span class="op">[[</span><span class="st">"salinity"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">section</span><span class="op">[[</span><span class="st">"SA"</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">f</span>, main<span class="op">=</span><span class="st">""</span>, xlab<span class="op">=</span><span class="st">"(SA-SP)/SA"</span><span class="op">)</span></code></pre></div>
<p>An examination of worldwide spatial patterns is also informative, with the following producing such a graph.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">oce</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"levitus"</span>, package<span class="op">=</span><span class="st">"ocedata"</span><span class="op">)</span>
<span class="va">SSS</span> <span class="op">&lt;-</span> <span class="va">levitus</span><span class="op">$</span><span class="va">SSS</span>
<span class="va">dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">SSS</span><span class="op">)</span>
<span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>lon<span class="op">=</span><span class="va">levitus</span><span class="op">$</span><span class="va">longitude</span>, lat<span class="op">=</span><span class="va">levitus</span><span class="op">$</span><span class="va">latitude</span><span class="op">)</span>
<span class="va">SA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsw_SA_from_SP.html">gsw_SA_from_SP</a></span><span class="op">(</span><span class="va">levitus</span><span class="op">$</span><span class="va">SSS</span>, <span class="fl">0</span>, <span class="va">ll</span><span class="op">$</span><span class="va">lon</span>, <span class="va">ll</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span>
<span class="va">per</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">levitus</span><span class="op">$</span><span class="va">SSS</span> <span class="op">/</span> <span class="va">SA</span><span class="op">)</span>
<span class="fu">imagep</span><span class="op">(</span><span class="va">levitus</span><span class="op">$</span><span class="va">longitude</span>, <span class="va">levitus</span><span class="op">$</span><span class="va">latitude</span>, <span class="va">per</span>, col<span class="op">=</span><span class="va">oceColorsJet</span>,
       zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">per</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.999</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Percent difference between "</span> <span class="op">*</span> <span class="va">S</span><span class="op">[</span><span class="va">A</span><span class="op">]</span> <span class="op">*</span> <span class="st">" and "</span> <span class="op">*</span> <span class="va">S</span><span class="op">[</span><span class="va">P</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Note the use of quantile-specified scales for the images, the colour mappings of which would otherwise be controlled by isolated low-saline waters, yielding little to see in the wider expanses of the world ocean; a broader context has been detailed in the literature (McDougall et al. 2012).</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Graham, F. S. and T. J. McDougall, 2012. Quantifying the Nonconservative Production of Conservative Temperature, Potential Temperature, and Entropy. Journal of Physical Oceanography, 43(5):838-862. <a href="http://dx.doi.org/10.1175/JPO-D-11-0188.1">http://dx.doi.org/10.1175/JPO-D-11-0188.1</a></p>
<p>IOC and SCOR and IAPSO, 2010. Intergovernmental Oceanographic Commission, Manuals and Guide, 56, UNESCO. <a href="http://www.teos-10.org/pubs/TEOS-10_Manual.pdf">http://www.teos-10.org/pubs/TEOS-10_Manual.pdf</a></p>
<p>Kelley, D., C. Richards and C. Layton, 2021. oce: Analysis of Oceanographic data, R package version 1.4-0. Comprehensive R Archive Network. <a href="https://CRAN.R-project.org/package=oce">https://CRAN.R-project.org/package=oce</a></p>
<p>McDougall, T. J. and P. M. Barker,2011. Getting started with TEOS-10 and the Gibbs Seawater (GSW) Oceanographic Toolbox. SCOR/IAPSO WG127. 978-0-646-55621-5.</p>
<p>McDougall, T. J., D. R. Jackett, F. J. Millero, R. Pawlowicz and P. M. Barker, 2012. A global algorithm for estimating Absolute Salinity. Ocean Science, 8:1123-1134. <a href="http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf">http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</a></p>
<p>Millero, F. J. 2010. History of the equation of state of seawater. Oceanography, 23:18-33. <a href="https://www.tos.org/oceanography/article/history-of-the-equation-of-state-of-seawater">https://www.tos.org/oceanography/article/history-of-the-equation-of-state-of-seawater</a></p>
<p>Pawlowicz, R., T. McDougall, R. Feistel and R. Tailleux, 2012. Preface ``An historical perspective on the development of the Thermodynamic Equation of Seawater–2010’’}. Ocean Science, 8:161-174. <a href="http://www.ocean-sci.net/8/161/2012/os-8-161-2012.pdf">http://www.ocean-sci.net/8/161/2012/os-8-161-2012.pdf</a></p>
<p>Wright, D. G., R. Pawlowicz, T. J. McDougall, R. Feistel and G. M. Marion, 2011. Absolute Salinity, Density Salinity and the Reference-Composition Salinity Scale: present and future use in the seawater standard TEOS-10. Ocean Science, 7:1-26. <a href="http://www.ocean-sci.net/7/1/2011/os-7-1-2011.pdf">http://www.ocean-sci.net/7/1/2011/os-7-1-2011.pdf</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Dan Kelley, Clark Richards, WG127 SCOR/IAPSO.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
